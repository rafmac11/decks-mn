<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Request a Free Quote</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --green-dark: #2C3E2D;
      --green-mid: #3A5139;
      --green-accent: #4A6B4A;
      --green-light: #E8F0E8;
      --green-lightest: #F2F7F2;
      --cream: #FAF8F5;
      --border: #D4D0CA;
      --border-focus: #2C3E2D;
      --text-primary: #1A1A1A;
      --text-secondary: #6B6660;
      --text-placeholder: #A8A29E;
      --icon-color: #9C9790;
      --white: #FFFFFF;
      --error: #C43E3E;
      --success: #2C6E2C;
      --radius: 12px;
      --radius-sm: 10px;
      --shadow-card: 0 2px 8px rgba(0,0,0,0.04), 0 12px 40px rgba(0,0,0,0.06);
      --transition: 200ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    body {
      font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--cream);
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
      -webkit-font-smoothing: antialiased;
    }

    /* ── Card ── */
    .form-card {
      background: var(--white);
      border-radius: 18px;
      box-shadow: var(--shadow-card);
      width: 100%;
      max-width: 560px;
      position: relative;
      overflow: hidden;
    }

    /* ── Progress bar ── */
    .progress-track {
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 3px;
      background: #E8E5E0;
      z-index: 1;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--green-dark), var(--green-accent));
      transition: width 500ms cubic-bezier(0.4, 0, 0.2, 1);
      width: 33.3%;
    }

    /* ── Header ── */
    .form-header {
      padding: 36px 36px 0;
    }
    .form-title {
      font-family: 'Playfair Display', Georgia, serif;
      font-weight: 600;
      font-size: 26px;
      color: var(--text-primary);
      margin-bottom: 4px;
    }
    .form-subtitle {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 0;
    }

    /* ── Step dots ── */
    .step-dots {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 20px 0 8px;
    }
    .dot {
      width: 8px; height: 8px;
      border-radius: 50%;
      background: var(--border);
      transition: all 300ms ease;
    }
    .dot.active {
      background: var(--green-dark);
      width: 24px;
      border-radius: 4px;
    }
    .dot.done { background: var(--green-accent); }

    /* ── Slider ── */
    .slider-viewport {
      overflow: hidden;
      position: relative;
    }
    .slider-track {
      display: flex;
      transition: transform 450ms cubic-bezier(0.4, 0, 0.2, 1);
      will-change: transform;
    }
    .slide {
      min-width: 100%;
      padding: 20px 36px 32px;
    }

    /* ── Step label ── */
    .step-label {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.07em;
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .step-label .step-num {
      width: 20px; height: 20px;
      background: var(--green-dark);
      color: #fff;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 700;
    }

    /* ── Service Grid ── */
    .service-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
    }
    .service-card {
      position: relative;
      background: var(--white);
      border: 1.5px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 14px 6px 12px;
      text-align: center;
      cursor: pointer;
      transition: all var(--transition);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      user-select: none;
    }
    .service-card:hover {
      border-color: var(--green-accent);
      background: var(--green-lightest);
    }
    .service-card.selected {
      border-color: var(--green-dark);
      background: var(--green-light);
      box-shadow: 0 0 0 2px rgba(44, 62, 45, 0.15);
    }
    .service-card.selected .svc-icon { color: var(--green-dark); }
    .service-card input { position: absolute; opacity: 0; pointer-events: none; }

    .svc-icon {
      width: 28px; height: 28px;
      color: var(--icon-color);
      transition: color var(--transition);
    }
    .service-card:hover .svc-icon { color: var(--green-accent); }

    .service-name {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-primary);
      line-height: 1.25;
    }

    .svc-check {
      position: absolute;
      top: 5px; right: 5px;
      width: 16px; height: 16px;
      background: var(--green-dark);
      color: #fff;
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
    }
    .service-card.selected .svc-check { display: flex; }

    /* ── Inputs ── */
    .field-group { margin-bottom: 18px; }
    .field-group:last-child { margin-bottom: 0; }

    label.field-label {
      display: block;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 6px;
    }
    label .req { color: var(--text-secondary); font-weight: 400; }

    .input-wrap {
      position: relative;
      display: flex;
      align-items: center;
    }
    .input-icon {
      position: absolute;
      left: 13px;
      width: 17px; height: 17px;
      color: var(--icon-color);
      pointer-events: none;
      transition: color var(--transition);
    }
    input, textarea {
      width: 100%;
      padding: 12px 14px 12px 40px;
      font-family: inherit;
      font-size: 14px;
      color: var(--text-primary);
      background: var(--white);
      border: 1.5px solid var(--border);
      border-radius: var(--radius);
      outline: none;
      transition: border-color var(--transition), box-shadow var(--transition);
    }
    input::placeholder, textarea::placeholder { color: var(--text-placeholder); }
    input:focus, textarea:focus {
      border-color: var(--border-focus);
      box-shadow: 0 0 0 3px rgba(44, 62, 45, 0.10);
    }
    input:focus ~ .input-icon, textarea:focus ~ .input-icon { color: var(--green-dark); }

    .input-wrap.has-error input,
    .input-wrap.has-error textarea { border-color: var(--error); box-shadow: 0 0 0 3px rgba(196,62,62,0.08); }
    .field-error { font-size: 12px; color: var(--error); margin-top: 4px; display: none; }
    .field-error.visible { display: block; }

    textarea {
      min-height: 90px;
      resize: vertical;
      line-height: 1.5;
      padding-top: 12px;
    }

    .field-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    /* ── Inline zip + financing ── */
    .detail-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }

    /* ── Financing ── */
    .financing-options { display: flex; gap: 8px; }
    .fin-btn {
      flex: 1;
      padding: 12px 10px;
      font-family: inherit;
      font-size: 13.5px;
      font-weight: 500;
      color: var(--text-primary);
      background: var(--white);
      border: 1.5px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: all var(--transition);
    }
    .fin-btn:hover { border-color: var(--green-accent); background: var(--green-lightest); }
    .fin-btn.selected {
      border-color: var(--green-dark);
      background: var(--green-light);
      box-shadow: 0 0 0 2px rgba(44, 62, 45, 0.15);
      font-weight: 600;
    }
    .fin-btn svg { width: 16px; height: 16px; }

    /* ── Back link ── */
    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 13px;
      color: var(--text-secondary);
      cursor: pointer;
      background: none;
      border: none;
      font-family: inherit;
      margin-bottom: 16px;
      transition: color var(--transition);
    }
    .back-link:hover { color: var(--text-primary); }
    .back-link svg { width: 16px; height: 16px; }

    /* ── Submit ── */
    .submit-btn {
      width: 100%;
      padding: 15px 24px;
      margin-top: 6px;
      font-family: inherit;
      font-size: 15px;
      font-weight: 600;
      color: var(--white);
      background: var(--green-dark);
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      transition: background var(--transition), transform 80ms ease, opacity var(--transition);
    }
    .submit-btn:hover { background: var(--green-mid); }
    .submit-btn:active { transform: scale(0.985); }
    .submit-btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .submit-btn svg { width: 18px; height: 18px; }

    .btn-spinner {
      width: 18px; height: 18px;
      border: 2.5px solid rgba(255,255,255,0.3);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.6s linear infinite;
      display: none;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .disclaimer {
      text-align: center;
      font-size: 11.5px;
      color: var(--text-secondary);
      margin-top: 14px;
      line-height: 1.45;
    }

    /* ── Success ── */
    .success-state { display: none; text-align: center; padding: 48px 36px; }
    .success-state.visible { display: block; }
    .success-icon-wrap {
      width: 56px; height: 56px;
      background: var(--green-light);
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 16px;
    }
    .success-icon-wrap svg { width: 28px; height: 28px; color: var(--success); }
    .success-state h2 { font-family: 'Playfair Display', serif; font-size: 22px; margin-bottom: 8px; }
    .success-state p { color: var(--text-secondary); font-size: 14px; line-height: 1.5; }

    /* ── Responsive ── */
    @media (max-width: 480px) {
      .form-card { border-radius: 14px; }
      .form-header { padding: 28px 24px 0; }
      .slide { padding: 16px 24px 28px; }
      .form-title { font-size: 22px; }
      .service-grid { grid-template-columns: repeat(2, 1fr); }
      .detail-row, .field-row { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<div class="form-card" id="formCard">
  <div class="progress-track"><div class="progress-fill" id="progressFill"></div></div>

  <!-- Header (always visible) -->
  <div class="form-header">
    <h1 class="form-title">Request a Free Quote</h1>
    <p class="form-subtitle" id="stepSubtitle">Select a service to get started</p>
  </div>

  <!-- Step dots -->
  <div class="step-dots" id="stepDots">
    <div class="dot active" data-dot="0"></div>
    <div class="dot" data-dot="1"></div>
    <div class="dot" data-dot="2"></div>
  </div>

  <form id="quoteForm" novalidate>

    <!-- Slider -->
    <div class="slider-viewport">
      <div class="slider-track" id="sliderTrack">

        <!-- ═══ SLIDE 1: Services ═══ -->
        <div class="slide" data-slide="0">
          <div class="step-label"><span class="step-num">1</span> Select Your Service</div>
          <div class="service-grid" id="serviceGrid">

            <label class="service-card">
              <input type="radio" name="service" value="Custom Deck Building">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="24" width="40" height="18" rx="2"/><line x1="4" y1="33" x2="44" y2="33"/><path d="M12 24V14l12-8 12 8v10"/><rect x="19" y="16" width="10" height="8"/></svg>
              <span class="service-name">Custom Deck</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Hot Tub Decks">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><path d="M6 30h36v10a4 4 0 0 1-4 4H10a4 4 0 0 1-4-4V30z"/><path d="M10 30V18a8 8 0 0 1 8-8h12a8 8 0 0 1 8 8v12"/><path d="M15 10c0 2 1 4 2 6"/><path d="M22 8c0 2 1 5 2 7"/><path d="M29 10c0 2 1 4 2 6"/></svg>
              <span class="service-name">Hot Tub Decks</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Pool Decks">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><path d="M4 30c2 1.5 3 2.5 6 2.5s4-3 8-3 4 3 8 3 4-3 8-3c3 0 4 1 6 2.5"/><path d="M4 38c2 1.5 3 2.5 6 2.5s4-3 8-3 4 3 8 3 4-3 8-3c3 0 4 1 6 2.5"/><rect x="14" y="10" width="20" height="16" rx="2"/></svg>
              <span class="service-name">Pool Decks</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Porch Decks">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><path d="M6 42h36"/><path d="M10 42V16l14-8 14 8v26"/><path d="M18 42v-12h12v12"/><path d="M6 22h36"/></svg>
              <span class="service-name">Porch Decks</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Cedar Decks">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><path d="M24 44V16"/><path d="M10 24l14-14 14 14"/><path d="M6 34l18-14 18 14"/><path d="M2 44l22-14 22 14"/></svg>
              <span class="service-name">Cedar Decks</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Composite Decks">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="20" width="36" height="22" rx="2"/><line x1="6" y1="30" x2="42" y2="30"/><line x1="6" y1="38" x2="42" y2="38"/><rect x="12" y="10" width="10" height="10"/><rect x="26" y="10" width="10" height="10"/></svg>
              <span class="service-name">Composite Decks</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Deck Repair & Restoration">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><path d="M28 12a2 2 0 0 0 0 3l5 5a2 2 0 0 0 3 0l7-7a12 12 0 0 1-16 16L13 43a4.24 4.24 0 0 1-6-6l14-14A12 12 0 0 1 37 7l-9 5z"/></svg>
              <span class="service-name">Repair &amp; Restore</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Pergolas & Structures">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="12" x2="40" y2="12"/><line x1="4" y1="20" x2="44" y2="20"/><line x1="12" y1="12" x2="12" y2="44"/><line x1="36" y1="12" x2="36" y2="44"/><line x1="4" y1="20" x2="8" y2="12"/><line x1="44" y1="20" x2="40" y2="12"/><line x1="20" y1="20" x2="20" y2="44"/><line x1="28" y1="20" x2="28" y2="44"/></svg>
              <span class="service-name">Pergolas</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Deck Stairs">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><path d="M8 42h8v-8h8v-8h8v-8h8V8"/></svg>
              <span class="service-name">Deck Stairs</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Deck Railings">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><line x1="6" y1="18" x2="42" y2="18"/><line x1="6" y1="42" x2="42" y2="42"/><line x1="10" y1="18" x2="10" y2="42"/><line x1="18" y1="18" x2="18" y2="42"/><line x1="26" y1="18" x2="26" y2="42"/><line x1="34" y1="18" x2="34" y2="42"/><line x1="42" y1="18" x2="42" y2="42"/><circle cx="10" cy="12" r="3"/><circle cx="42" cy="12" r="3"/></svg>
              <span class="service-name">Deck Railings</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Deck Lighting">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><path d="M18 36h12"/><path d="M20 42h8"/><line x1="24" y1="4" x2="24" y2="8"/><path d="M24 14a8 8 0 0 1 8 8c0 4-3 7-4 9s-2 3-4 3-3-1-4-3-4-5-4-9a8 8 0 0 1 8-8z"/><line x1="8" y1="8" x2="11" y2="11"/><line x1="40" y1="8" x2="37" y2="11"/><line x1="4" y1="24" x2="8" y2="24"/><line x1="44" y1="24" x2="40" y2="24"/></svg>
              <span class="service-name">Deck Lighting</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Commercial Deck Building">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="14" width="40" height="30" rx="2"/><path d="M12 14V10a4 4 0 0 1 4-4h16a4 4 0 0 1 4 4v4"/><line x1="4" y1="26" x2="44" y2="26"/><rect x="18" y="22" width="12" height="8" rx="1"/></svg>
              <span class="service-name">Commercial</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Deck Columns & Posts">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><rect x="8" y="6" width="12" height="36" rx="2"/><rect x="28" y="6" width="12" height="36" rx="2"/><line x1="4" y1="42" x2="44" y2="42"/><line x1="4" y1="6" x2="44" y2="6"/></svg>
              <span class="service-name">Columns &amp; Posts</span>
            </label>

            <label class="service-card">
              <input type="radio" name="service" value="Other">
              <div class="svc-check"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></div>
              <svg class="svc-icon" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"><circle cx="24" cy="24" r="20"/><line x1="24" y1="16" x2="24" y2="32"/><line x1="16" y1="24" x2="32" y2="24"/></svg>
              <span class="service-name">Other</span>
            </label>

          </div>
        </div>

        <!-- ═══ SLIDE 2: Zip + Financing ═══ -->
        <div class="slide" data-slide="1">
          <button type="button" class="back-link" id="backTo0">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
            Back
          </button>
          <div class="step-label"><span class="step-num">2</span> Project Details</div>

          <div class="detail-row">
            <div>
              <label class="field-label" for="zipCode">Zip Code <span class="req">*</span></label>
              <div class="input-wrap">
                <input type="text" id="zipCode" name="zipCode" placeholder="55369" required maxlength="5" inputmode="numeric" autocomplete="postal-code">
                <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
              </div>
              <div class="field-error" id="zipCodeError">Enter a valid zip code</div>
            </div>
            <div>
              <label class="field-label">Need Financing?</label>
              <div class="financing-options">
                <button type="button" class="fin-btn" id="finYes">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                  Yes
                </button>
                <button type="button" class="fin-btn" id="finNo">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
                  No
                </button>
              </div>
              <input type="hidden" id="financing" name="financing" value="">
            </div>
          </div>
        </div>

        <!-- ═══ SLIDE 3: Contact ═══ -->
        <div class="slide" data-slide="2">
          <button type="button" class="back-link" id="backTo1">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
            Back
          </button>
          <div class="step-label"><span class="step-num">3</span> Contact Information</div>

          <div class="field-group">
            <label class="field-label" for="fullName">Full Name <span class="req">*</span></label>
            <div class="input-wrap">
              <input type="text" id="fullName" name="fullName" placeholder="Your name" required autocomplete="name">
              <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            </div>
            <div class="field-error" id="fullNameError">Please enter your name</div>
          </div>

          <div class="field-group">
            <div class="field-row">
              <div>
                <label class="field-label" for="email">Email <span class="req">*</span></label>
                <div class="input-wrap">
                  <input type="email" id="email" name="email" placeholder="you@example.com" required autocomplete="email">
                  <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                </div>
                <div class="field-error" id="emailError">Enter a valid email</div>
              </div>
              <div>
                <label class="field-label" for="phone">Phone</label>
                <div class="input-wrap">
                  <input type="tel" id="phone" name="phone" placeholder="(612) 555-0123" autocomplete="tel">
                  <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                </div>
              </div>
            </div>
          </div>

          <div class="field-group">
            <label class="field-label" for="message">Your Message <span class="req">*</span></label>
            <div class="input-wrap">
              <textarea id="message" name="message" placeholder="Tell us about your deck project..." required></textarea>
              <svg class="input-icon" style="top:14px;align-self:flex-start;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
            </div>
            <div class="field-error" id="messageError">Please describe your project</div>
          </div>

          <button type="submit" class="submit-btn" id="submitBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
            <span id="btnText">Request Free Quote</span>
            <div class="btn-spinner" id="btnSpinner"></div>
          </button>

          <p class="disclaimer">
            By submitting this form, you agree to be contacted regarding your deck project. Your information is kept confidential.
          </p>
        </div>

      </div>
    </div>
  </form>

  <!-- Success -->
  <div class="success-state" id="successState">
    <div class="success-icon-wrap">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
    </div>
    <h2>Thank You!</h2>
    <p>We received your quote request and will be in touch shortly to discuss your deck project.</p>
  </div>
</div>

<script>
(function () {
  "use strict";

  var form = document.getElementById("quoteForm");
  var sliderTrack = document.getElementById("sliderTrack");
  var progressFill = document.getElementById("progressFill");
  var stepSubtitle = document.getElementById("stepSubtitle");
  var submitBtn = document.getElementById("submitBtn");
  var btnText = document.getElementById("btnText");
  var btnSpinner = document.getElementById("btnSpinner");
  var successState = document.getElementById("successState");
  var dots = document.querySelectorAll(".dot");

  var totalSteps = 3;
  var currentStep = 0;
  var financingSelected = false;
  var subtitles = [
    "Select a service to get started",
    "Tell us where you are",
    "Almost done — how can we reach you?"
  ];

  // ── Navigate slides ──
  function goToStep(index) {
    if (index < 0 || index >= totalSteps) return;
    currentStep = index;

    // Slide
    sliderTrack.style.transform = "translateX(-" + (currentStep * 100) + "%)";

    // Progress
    progressFill.style.width = ((currentStep + 1) / totalSteps * 100) + "%";

    // Subtitle
    stepSubtitle.textContent = subtitles[currentStep];

    // Dots
    dots.forEach(function (dot, i) {
      dot.classList.remove("active", "done");
      if (i === currentStep) dot.classList.add("active");
      else if (i < currentStep) dot.classList.add("done");
    });

    // Focus first input on new slide
    var slide = document.querySelector('[data-slide="' + currentStep + '"]');
    var input = slide.querySelector("input:not([type=hidden]):not([type=radio]), textarea");
    if (input) setTimeout(function () { input.focus(); }, 500);
  }

  // ── STEP 1: Service cards ──
  var cards = document.querySelectorAll(".service-card");
  cards.forEach(function (card) {
    card.addEventListener("click", function () {
      cards.forEach(function (c) { c.classList.remove("selected"); });
      this.classList.add("selected");
      this.querySelector("input").checked = true;
      setTimeout(function () { goToStep(1); }, 350);
    });
  });

  // ── STEP 2: Zip code + Financing ──
  var zipInput = document.getElementById("zipCode");
  var finYes = document.getElementById("finYes");
  var finNo = document.getElementById("finNo");
  var finHidden = document.getElementById("financing");

  zipInput.addEventListener("input", function () {
    this.value = this.value.replace(/\D/g, "").slice(0, 5);
    if (this.value.length === 5 && financingSelected) {
      setTimeout(function () { goToStep(2); }, 300);
    }
  });
  zipInput.addEventListener("keydown", function (e) {
    if (e.key === "Enter") {
      e.preventDefault();
      if (this.value.length >= 5 && financingSelected) goToStep(2);
    }
  });

  function selectFinancing(value) {
    financingSelected = true;
    finHidden.value = value;
    finYes.classList.toggle("selected", value === "yes");
    finNo.classList.toggle("selected", value === "no");
    if (zipInput.value.length >= 5) {
      setTimeout(function () { goToStep(2); }, 300);
    }
  }
  finYes.addEventListener("click", function () { selectFinancing("yes"); });
  finNo.addEventListener("click", function () { selectFinancing("no"); });

  // ── Back buttons ──
  document.getElementById("backTo0").addEventListener("click", function () { goToStep(0); });
  document.getElementById("backTo1").addEventListener("click", function () { goToStep(1); });

  // ── Phone format ──
  var phoneInput = document.getElementById("phone");
  phoneInput.addEventListener("input", function () {
    var d = this.value.replace(/\D/g, "").slice(0, 10);
    if (d.length >= 7) this.value = "(" + d.slice(0,3) + ") " + d.slice(3,6) + "-" + d.slice(6);
    else if (d.length >= 4) this.value = "(" + d.slice(0,3) + ") " + d.slice(3);
    else if (d.length > 0) this.value = "(" + d;
  });

  // ── Validation ──
  function validateField(id) {
    var field = document.getElementById(id);
    var errorEl = document.getElementById(id + "Error");
    var wrap = field.closest(".input-wrap");
    var valid = true;
    if (id === "fullName" && field.value.trim().length < 2) valid = false;
    if (id === "email" && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(field.value.trim())) valid = false;
    if (id === "message" && !field.value.trim()) valid = false;
    if (id === "zipCode" && !/^\d{5}$/.test(field.value.trim())) valid = false;
    if (wrap) wrap.classList.toggle("has-error", !valid);
    if (errorEl) errorEl.classList.toggle("visible", !valid);
    return valid;
  }

  ["fullName", "email", "message", "zipCode"].forEach(function (id) {
    document.getElementById(id).addEventListener("input", function () {
      var wrap = this.closest(".input-wrap");
      var err = document.getElementById(id + "Error");
      if (wrap) wrap.classList.remove("has-error");
      if (err) err.classList.remove("visible");
    });
  });

  // ── Submit ──
  form.addEventListener("submit", async function (e) {
    e.preventDefault();
    var v1 = validateField("zipCode");
    var v2 = validateField("fullName");
    var v3 = validateField("email");
    var v4 = validateField("message");
    if (!v1) { goToStep(1); return; }
    if (!v2 || !v3 || !v4) {
      var first = !v2 ? "fullName" : !v3 ? "email" : "message";
      document.getElementById(first).focus();
      return;
    }
    var serviceRadio = document.querySelector('input[name="service"]:checked');
    submitBtn.disabled = true;
    btnText.textContent = "Submitting...";
    btnSpinner.style.display = "block";

    var payload = {
      service: serviceRadio ? serviceRadio.value : "",
      zipCode: zipInput.value.trim(),
      financing: finHidden.value,
      fullName: document.getElementById("fullName").value.trim(),
      email: document.getElementById("email").value.trim(),
      phone: phoneInput.value.trim(),
      message: document.getElementById("message").value.trim(),
    };

    try {
      var res = await fetch("/api/submit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });
      var data = await res.json();
      if (data.success) {
        form.style.display = "none";
        document.querySelector(".form-header").style.display = "none";
        document.getElementById("stepDots").style.display = "none";
        progressFill.style.width = "100%";
        successState.classList.add("visible");
      } else {
        throw new Error(data.error || "Submission failed");
      }
    } catch (err) {
      alert(err.message || "Something went wrong. Please try again.");
      submitBtn.disabled = false;
      btnText.textContent = "Request Free Quote";
      btnSpinner.style.display = "none";
    }
  });
})();
</script>

</body>
</html>
